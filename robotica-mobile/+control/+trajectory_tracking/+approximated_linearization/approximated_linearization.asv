function newXg = approximated_linearization(Ts, Xg, xstar, ystar, xdstar, ydstar,...
                                           xddstar, yddstar, thetastar)
    
              
    x = Xg(1);
    y = Xg(2);
    theta = Xg(3);
    
    vstar = sqrt(xdstar^2 + ydstar^2);
    if isequal(vstar,0)
        omegastar = 0.01;
    else
        omegastar = (yddstar*xdstar-ydstar*xddstar)/(vstar^2);
    end
    
    
    a = 1;
    delta = 0.99;
    
    K1 = 2*delta*a;
    if isequal(vstar,0)
        vstar
    else
        K2 = (a^2 - omegastar^2)/vstar;
    end
    K3 = 2*delta*a;
    
    
    ex = xstar - x;
    ey = ystar - y;
    import control.angle.delta_angle;
    etheta = delta_angle(thetastar, theta);
    
    u1 = -K1*ex;
    u2 = -K2*ey - K3*etheta;
    
    v = vstar * cos(etheta) - u1;
    w = omegastar - u2;

    newXg = [x*Ts*v*cos(theta) ; y+Ts*v*sin(theta) ; theta+Ts*w];
    
end